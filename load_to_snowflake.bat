@echo off
echo ========================================
echo   Load Data to Snowflake
echo ========================================
echo.
echo This script will load JSON data files generated by the
echo enhanced e-commerce analytics app into Snowflake.
echo.
echo üìÅ Data Sources:
echo   ‚Ä¢ JSON files from data/processed/ directory
echo   ‚Ä¢ Generated by the enhanced analytics pipeline
echo.
echo üéØ Loading Process:
echo   1. Connect to Snowflake
echo   2. Load JSON files into RAW_EVENTS table
echo   3. Process raw events into structured tables
echo   4. Archive processed files
echo   5. Display loading statistics
echo.
echo üìä Target Tables:
echo   ‚Ä¢ RAW_DATA.RAW_EVENTS (all events)
echo   ‚Ä¢ PROCESSED_DATA.PAGE_VIEWS
echo   ‚Ä¢ PROCESSED_DATA.PRODUCT_INTERACTIONS
echo   ‚Ä¢ PROCESSED_DATA.PURCHASES
echo   ‚Ä¢ PROCESSED_DATA.SEARCHES
echo   ‚Ä¢ PROCESSED_DATA.USER_ENGAGEMENT
echo.
echo ‚ö†Ô∏è  Prerequisites:
echo   ‚Ä¢ Snowflake setup completed (run setup_snowflake.bat first)
echo   ‚Ä¢ Valid credentials in snowflake_config.json
echo   ‚Ä¢ JSON data files in data/processed/ directory
echo.
pause

echo.
echo üöÄ Starting data loading to Snowflake...
echo.

call kafka_venv\Scripts\activate.bat
python snowflake_loader.py

echo.
echo Loading completed! Check the output above for statistics.
echo.
pause